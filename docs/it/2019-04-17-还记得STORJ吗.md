# 2019-04-17 还记得STORJ吗？

## You're Invited! Storj V3 网络实战

### 应该等了3个季度吧

等了三个季度，才收到了邀请邮件，邮件内容如下：
> 感谢您加入 Storj 网络并注册储存节点名单。你现受邀请，在今年测试版本 （Pioneer）和年未成品（Voyager）发布前，设置您的存储节点（Storage Node）以累积声誉 （Reputation）和赚取 Storj Token。

> 在设置您的储存节点之前，请花一点时间阅读有关成为储存节点经营者（Storage Node Operator）的须知。

> 并不是所有人都有资格运营V3网络上的存储节点。一些运营者没有所需的带宽或存储容量来实现财务意义。 要了解作为V3上的节点运营者是否具有经济意义，考虑到你的硬件和带宽可用性，请访问我们创建的估算工具。在设置节点之前，请花点时间阅读我们的存储节点运营者的摘要博客。


> ## 設置教學
> 尝试节点估算器

> 我们在存储节点运营商的alpha版本之前的最近几个月发布了大量内容。如果你在设置节点之前花时间阅读我们的存储节点运营商摘要博客，我们将不胜感激。

> 邮件里附带了你的一次性授权码，用于注册你的节点认证：

> 申请邮件地址:xxxxxxxxxxxx代码

> 通过使用授权码，视你同意受存储共享服务条款的约束。

> ### 设置说明

> 要设置存储节点并将其连接到Satellite，请按照我们的GitHub上的说明进行操作。

> 在我们的alpha阶段，Storj Labs将控制整个网络中的新数据流。在我们准备Vanguard版本时，这些数据将用于测试目的，该版本将为用户和合作伙伴打开网络以开始存储数据。

> ### 支持

> 请加入我们的社区聊天，并将任何存储节点问题指向#storagenode频道。

>我们热爱社区的想法，并欢迎我们的想法门户网站提出建议。

> 如果您发现产品中存在任何错误，可以在社区报告。

> 我们开源，且总是通过GitHub接受对代码库的贡献。

> *重要* 你将无法使用授权令牌设置多个节点。与我们的V2网络相比，在V3上设置多个存储节点没有任何好处。如果您有10 TB可用数据，则10TB的单个节点与两个5TB节点上的收益潜力没有区别。有关更多详细信息，请阅读我们最近的存储节点博客文章和V3白皮书。

> 如果你仍在运行V2节点，我们建议你保持此节点运行，直到V3 beta。

> 如果你将Windows Home作为节点的操作系统运行，则在运行Docker映像时会遇到问题。Windows Home用户需要等待即将到来的二进制更新才能加入V3网络，或者需要切换到其他操作系统。如果你想在加入网络之前等到我们的二进制文件更新，请保存您的授权令牌，我们将在更正此问题时通知所有存储节点被邀请者。

## 配置方法

### 资源管理器发布已发布了！
你好！Storj节点运营商！首先，我们要感谢您的耐心等待。我们知道很多人已经等了几个月才加入V3网络。你的耐心得到了回报；您是第一个被邀请进入Explorer版本的幸运儿。

此版本是限制数量邀请的，这意味着我们正在控制有多少节点能够加入网络以及它们能够以多快的速度执行此操作。我们希望让我们的早期采用者有机会开始赢得声誉和STORJ代币。

如果我们允许太多节点立即加入网络，那么您将获得更少的STORJ代币，因为可用数据自然会分布在更多节点上。Storj Labs将在此版本中向网络上传足够的数据，以确保所有存储节点获得支付。

此版本的目标是开始构建可靠的长期存储节点供应。公共alpha中的步骤很复杂，绝对针对更技术性的受众。

如果这些说明比您能处理的要复杂一些，请不要担心！随着我们从alpha进展到beta，我们将不断为不太技术的用户提供更轻松，更易于访问的流程。

### 重要的安全考虑
* 我们的软件提供来自互联网的请求，但并非您安装的所有软件都设计为直接暴露在互联网上！没有防火墙的帮助，请勿将计算机直接连接到Internet。对于应用程序上响应所有IP请求的Windows用户来说，尤其如此。

### 在你开始之前
确保您收到一封包含个人一次性授权令牌的电子邮件。请注意，授权令牌的格式为email：characterstring。如果您还没有授权令牌，请加入我们的等待名单。

**注意：** 此早期版本对某些操作系统的支持有限。如果您的操作系统未得到明确支持，请保存您的一次性授权令牌，我们会在不再出现此问题时通知所有人。

使用以下步骤安装必要的依赖项并正确配置网络：

* 确保您的计算机未直接连接到互联网。如果你已经有一个正常的路由器，你应该没问题。请参阅重要安全注意事项部分。
* 安装docker。请访问：docker.com并按照操作系统的安装指南进行操作。
	* 注意：不支持Docker Toolbox
* 设置端口转发和动态DNS！您必须指定的端口是28967。请访问我们的知识库文章或portforward.com并按照路由器的说明进行操作。

### 在V3网络上设置存储节点！
**注意：** *强烈建议在机器本地执行以下步骤，而不是通过远程连接。如果必须使用远程连接，由于某些步骤需要很长时间，因此强烈建议在TMUX或SCREEN等虚拟控制台中运行它们。（实践中遇到的是第二个步骤时计算加密密钥，消耗了非常久的时间，如果用远程连接，可能因为太久没有交互而断开，计算也随之终止）*

一、 下载Identity工具二进制文件并创建标识。生成身份的过程可能需要几个小时；这取决于您的机器的处理能力和运气。

为您的操作系统下载正确的二进制文件：
* https://github.com/storj/docs/blob/master/Explorer-Release-Setup-Instructions.md

**注意：** *如果您使用的是Synology NAS或其他具有较低计算能力的设备，建议在功能更强大的计算机上创建Identity并将其传输到较小的设备。*

二、解压缩文件并运行以下命令以开始创建标识（此示例适用于Mac OS，替换适用于您的操作系统的标识二进制文件）：

``` ./identity_darwin_amd64 create storagenode```

三、使用您的个人一次性授权令牌对您创建的身份进行签名，方法是运行以下命令：通过使用授权令牌，您同意受存储共享条款和条件的约束。

```$ ./identity_darwin_amd64 authorize storagenode <authorization-token>```

**注意：** *如果您使用Synology，则必须在命令前添加“sudo”以创建和签署身份。否则你会收到错误。 Synology上创建的身份的默认文件夹是/root/.local/share/storj/identity/storagenode/*

**警告：** *在继续执行下一步之前，请务必备份位于上一个命令的输出路径中的身份文件。这将允许您在发生诸如硬盘驱动器崩溃等不幸事件时将节点恢复到正常工作状态。*

四、从docker hub下载docker容器：
```$ docker pull storjlabs/storagenode：alpha```

*对于Raspberry Pi和类似的基于ARM的平台，使用：* 

```$ docker pull storjlabs/storagenode：arm```

*对于使用Intel CPU的Synology NAS，请使用：*

```$ sudo docker pull storjlabs/storagenode：alpha```

五、在编辑WALLET，EMAIL，ADDRESS，BANDWIDTH，STORAGE，<identity-dir>和<storage-d后，使用以下命令运行存储节点。

* WALLET：付款的以太坊地址
* EMAIL：电子邮件地址，以便我们可以在新版本发布时通知您（可选）
* ADDRESS：外部IP地址或您配置的DDNS以及在路由器上打开的端口<ip>：<端口>
	* **注意：** *如果您使用的是28967以外的自定义端口，则必须将 -p 28967：28967更改为-p <端口>：28967* 
* BANDWIDTH：您希望为Storj网络分配多少带宽（算了一下至少要写20T）
* STORAGE：您要为Storj网络分配多少磁盘空间（目前配置了1.5T）
* \<identity-dir>：您的身份文件的位置。 您可以从先前运行的标识命令的输出中复制绝对路径
* \<storage-dir>：您希望文件存储在网络硬盘上的本地目录

```
$ docker run -d --restart unless-stopped -p 28967:28967 \
    -e WALLET="0xXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" \
    -e EMAIL="user@example.com" \
    -e ADDRESS="domain.ddns.net:28967" \
    -e BANDWIDTH="2TB" \
    -e STORAGE="2TB" \
    -v "<identity-dir>":/app/identity \
    -v "<storage-dir>":/app/config \
    --name storagenode storjlabs/storagenode:alpha
```

对于Raspberry Pi和类似的基于ARM的平台，使用：

```
$ docker run -d --restart unless-stopped -p 28967:28967 \
    -e WALLET="0xXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" \
    -e EMAIL="user@example.com" \
    -e ADDRESS="domain.ddns.net:28967" \
    -e BANDWIDTH="2TB" \
    -e STORAGE="2TB" \
    -v "<identity-dir>":/app/identity \
    -v "<storage-dir>":/app/config \
    --name storagenode storjlabs/storagenode:arm
```

对于Synology NAS，请使用：

```
$ sudo docker run -d --restart unless-stopped -p 28967:28967 \
    -e WALLET="0xXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" \
    -e EMAIL="user@example.com" \
    -e ADDRESS="domain.ddns.net:28967" \
    -e BANDWIDTH="2TB" \
    -e STORAGE="2TB" \
    -v "<identity-dir>":/app/identity \
    -v "<storage-dir>":/app/config \
    --name storagenode storjlabs/storagenode:alpha
```

对于Windows操作系统，请使用以下行：

```
$ docker run -d --restart unless-stopped -p 28967:28967 -e WALLET="0xXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" -e EMAIL="user@example.com" -e ADDRESS="domain.ddns.net:28967" -e BANDWIDTH="2TB" -e STORAGE="2TB" -v "<identity-dir>":/app/identity -v "<storage-dir>":/app/config --name storagenode storjlabs/storagenode:alpha

```
**注意：** *在Windows上，您需要格式化以下路径：D:\\identity\\storagenode\\或D:\\data\\

六、运行以下命令启动存储节点仪表板：

```$ docker exec -it storagenode /app/dashboard.sh```

七、如果步骤5或6失败，请运行：

```$ docker logs -t storagenode```

**注意：** 如果您使用的是Synology，则必须在命令前添加“sudo”。

*如果您在设置存储节点时需要帮助，请注册我们的社区聊天并在#storagenode频道中寻求帮助。 在出席您的问题的社区领导的要求下提供您的日志和堆栈跟踪。* 

### 短时间关闭维护

如果您需要关闭storagenode以便在系统上进行短期维护，可以使用以下命令安全地将其关闭：

```$ docker stop storagenode```

完成维护后，您可以利用下列命令恢复：

```$ docker start storagenode```

### 升级存储节点
您可以使用以下命令使用watchtower为您的Storage Node容器设置自动更新。Watchtower将在docker hub上寻找docker容器的新更新，并在看到新版本时自动更新存储节点。这是确保您的存储节点保持最新的最佳方法。

```
$ docker run -d --restart=always --name watchtower -v /var/run/docker.sock:/var/run/docker.sock storjlabs/watchtower
```


### 手动执行更新的操作方法：
1、通过运行以下命令停止正在运行的storagenode容器：

```$ docker stop storagenode ```

2、通过运行以下命令删除现有容器：

```$ docker rm storagenode```

3、根据您节点的架构与版本结构，运行以下命令，为docker提取最新图像：

```$ docker pull storjlabs/storagenode:alpha```

或

```$ docker pull storjlabs/storagenode:arm```

4、在编辑WALLET，EMAIL，ADDRESS，BANDWIDTH，STORAGE，<identity-dir>和<storage-dir>之后运行以下命令，再次启动Storage节点。

```
$ docker run -d --restart unless-stopped -p 28967:28967 \
    -e WALLET="" \
    -e EMAIL="" \
    -e ADDRESS="" \
    -e BANDWIDTH="2TB" \
    -e STORAGE="2TB" \
    -v "<identity-dir>":/app/identity \
    -v "<storage-dir>":/app/config \
    --name storagenode storjlabs/storagenode:alpha
```

对于基于ARM的硬件，使用：

```
$ docker run -d --restart unless-stopped -p 28967:28967 \
    -e WALLET="" \
    -e EMAIL="" \
    -e ADDRESS="" \
    -e BANDWIDTH="2TB" \
    -e STORAGE="2TB" \
    -v "<identity-dir>":/app/identity \
    -v "<storage-dir>":/app/config \
    --name storagenode storjlabs/storagenode:arm
```

## 感谢您阅读我的文章

![请支持我的创作](https://sggggy.github.io/images/rewards_code.jpg)